# 数据提取与处理操作

## 一、数据提取操作及其应用场景

| 命令    | 功能                                                         |
| ------- | ------------------------------------------------------------ |
| `cut`   | 对文件、标准输入中的记录(一般按行)进行截取，**==通常使用awk代替cut==** |
| `sort`  | 对记录进行排序，可以指定排序标准，按数字、指定比较区间等     |
| `uniq`  | 去重操作，一般是对处理后的数据进行去重与统计                 |
| `tr`    | 对文件、标准输入进行字符替换，压缩(连续符号合并一个)，删除   |
| `split` | 对文件进行切分                                               |
| `grep`  | 对文件、标准输入进行检索与统计                               |
| `wc`    | 统计文件、标准输入的字符数、字数、行数                       |
| `xargs` | 参数代换，将管道的输出转为后一个命令的参数，而非标准输出流   |

### 1.`cut`命令

```bash
# cut常用选项：-d, -f
# -d(divide)选项指定切分的分隔符
# -f(field)选项指定截取的是切分的第几块，可以使用区间
cat /etc/passwd | cut -d ":" -f 1
cat /etc/passwd | cut -d ":" -f 3-
```

**cut命令进行记录截取**操作，切分出的结果通常作为下一条命令的输入。



### 2.`sort`命令

**sort命令用来对记录(可为中间结果)进行排序**，可以指定排序依赖的评判区间(需要明确分隔符与区间)，默认按照字典序，可以指定数字顺序。

```bash
# sort命令常用选项：-n, -r, -t, -k
cat /etc/passwd | sort #默认按照字典序排序
# -t :指定分隔符
# -k num：排序依赖的区间
# -n：(num)指定排序是按照数字序进行排序
# -r：(reverse)排序结果是逆序的
cat /etc/passwd | sort -t ":" -k 3 -n -r
```



### 3.`uniq`命令

`uniq`是专门的去重命令，其处理的通常是已经被其他数据处理命令处理过的结果。

**`uniq`命令通常会和`sort`命令配合使用，因为`uniq`命令只能对相邻连续重复元素去重，所以需要排序之后进行去重与频率统计。**

```bash
# uniq命令常用参数：-i, -c
# -c：(count)选项可以对元素进行出现次数统计
last -f /var/log/wtmp | head -n -2 | cut -d " " -f 1 | sort | uniq -c
# -i：(ignore)选项忽略大小写区别
```



### 4.`tr`命令(translate or delete character)

`tr`命令用来对文件、输入流进行**字符替换、字符压缩(连续相同字符归一)、字符删除。**

`tr`命令的**字符替换功能可以用于文件批量重命名**。

`tr`命令的**字符压缩功能可以用来统一格式**。

`tr`命令的字符删除功能，。。。。应用场景后续补充。

```bash
# tr命令常用的选项：-c, -d, -s, -t
# 默认情况下，tr命令将第一字符集中元素用第二字符集中相应位置元素代替
# -c：(complement)补全，即将不在第一字符集中的字符用后面的字符代替，后面理应只有一个字符
man ls | head -n 100 | tr -c 'a-z' '-'
# -d:(delete)删除属于第一字符集中的字符
man ls | head -n 100 | tr -d 'a-z'
# -s：(squeeze-repeats)根据指定字符集中的字符，将连续重复字符用一个该字符替换
echo "aaa bbb ccc ddd efg hijk" | tr -s 'a-z'
man ls | head -n 100 | tr -s " "
# -t：删除第一字符集较第二字符集多出的字符(不知道具体使用场景)
```



### 5.`split`命令

`split`命令用于对文件进行切分，应用于**大文件处理、分组/批处理事务、数据等。**

```bash
# split命令常用的参数： -l, -b
# -l num:按行进行文件切分，切分出来的新文件以指定的前缀生成文件
split -l 100 filename prefix
# -b size：将文件且分为size大小的文件，少用
```



### 6.`grep`命令

`grep`命令用于对文件、标准输入进行**匹配检索，非匹配检索(非匹配检索用于过滤无效数据)**，这个日常使用保证熟悉此操作。

```bash
# grep命令常用选项：-c, -i, -n, -v
# 默认输出能够匹配到的各行数据
ls -al | grep log
# -c：(count)统计搜寻到的次数
ls -al | grep -c log
# -i:(ignore)忽略大小写，少用
# -n:(number)顺序输出行号
# -n选项的作用，在检索到数据之后显示数据所在行，使得查看时方便定位
ls -al | grep -n log
# -v:(--invert-match)反向匹配，选择不匹配的行
ls -al | grep -v log
#grep -E regex,grep -E 支持扩展正则表达式匹配

# grep去除空行、某些匹配到的行
grep -v "^$" #去除空行
```



### 7.`wc`命令

`wc`命令对文件、标准输入流进行行数、字数、字符数统计。

**若用文件名作为参数，那么wc命令的输出中就会有文件名;==为了避免输出中欧冠还有文件名，可以使用cat将其转化为标准输出流进行输入。==**

```bash
#wc命令常用选项： -l,-w,-m
#默认输出行数、字数、字符数，如果文件作为输入则还有文件名
ll | wc
# -l:(line)仅列出行号
ll | wc -l
# -w：(word)仅列出多少字
ll | wc -w
# -m：仅列出多少字符
ll | wc -m
```



### 8.`xargs`命令指定参数代换

`xargs`用于将管道的输出转化为后一个命令的参数，而非标准输出流。

```bash
# 以cat为例，接受标准输入后就是直接进行标准输出，为此，需要将前一个命令的标准输出作为后一个命令的参数而不是标准输入
ls *.cpp| xargs cat | wc -l
# xargs的常用参数-n 
#xargs -n num指定了每次处理的参数个数
cat word.txt | xargs -n 1 echo
```

`xargs`命令使得**批量处理文件，统计信息**得以实现。

**`xargs`可以用于一切接受参数的命令，比方说ls，cat，more，less，echo这些，因此，应用非常广泛。**

对于包含空格与换行的单词文件，可以使用`xargs`参数将cat的标准输出经由`echo`得到实际的单词。